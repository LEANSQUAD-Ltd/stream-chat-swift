<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.72">
<link rel="alternate" type="application/rss+xml" href="/stream-chat-swift/blog/rss.xml" title="StreamChat Swift SDK Docs Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/stream-chat-swift/blog/atom.xml" title="StreamChat Swift SDK Docs Blog Atom Feed"><title data-react-helmet="true">StreamChat Cheat Sheet | StreamChat Swift SDK Docs</title><meta data-react-helmet="true" property="og:url" content="https://getstream.github.io/stream-chat-swift//stream-chat-swift/cheat-sheet"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="StreamChat Cheat Sheet | StreamChat Swift SDK Docs"><meta data-react-helmet="true" name="description" content="This cheat sheet provides additional information to the official StreamChat SDK documentation on our website. You can find here more detailed information, richer code snippets, and commentary to the provided solutions."><meta data-react-helmet="true" property="og:description" content="This cheat sheet provides additional information to the official StreamChat SDK documentation on our website. You can find here more detailed information, richer code snippets, and commentary to the provided solutions."><link data-react-helmet="true" rel="shortcut icon" href="https://getstream.imgix.net/images/favicons/favicon-96x96.png"><link data-react-helmet="true" rel="canonical" href="https://getstream.github.io/stream-chat-swift//stream-chat-swift/cheat-sheet"><link data-react-helmet="true" rel="alternate" href="https://getstream.github.io/stream-chat-swift//stream-chat-swift/cheat-sheet" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://getstream.github.io/stream-chat-swift//stream-chat-swift/cheat-sheet" hreflang="x-default"><link rel="stylesheet" href="/stream-chat-swift/assets/css/styles.284bd3b0.css">
<link rel="preload" href="/stream-chat-swift/assets/js/styles.725bd164.js" as="script">
<link rel="preload" href="/stream-chat-swift/assets/js/runtime~main.68d9852c.js" as="script">
<link rel="preload" href="/stream-chat-swift/assets/js/main.c61111f0.js" as="script">
<link rel="preload" href="/stream-chat-swift/assets/js/1.7f645e49.js" as="script">
<link rel="preload" href="/stream-chat-swift/assets/js/2.1b2f1115.js" as="script">
<link rel="preload" href="/stream-chat-swift/assets/js/3.1f8766f7.js" as="script">
<link rel="preload" href="/stream-chat-swift/assets/js/1be78505.65f3230c.js" as="script">
<link rel="preload" href="/stream-chat-swift/assets/js/57.a41a6dc4.js" as="script">
<link rel="preload" href="/stream-chat-swift/assets/js/935f2afb.560ad559.js" as="script">
<link rel="preload" href="/stream-chat-swift/assets/js/17896441.7cc4e2aa.js" as="script">
<link rel="preload" href="/stream-chat-swift/assets/js/1666e941.be513990.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/stream-chat-swift/"><img src="/stream-chat-swift/img/logo.svg" alt="StreamChat Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/stream-chat-swift/img/logo.svg" alt="StreamChat Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">StreamChat Swift SDK Docs</strong></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/GetStream/stream-chat-swift" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_GrZ2"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/stream-chat-swift/"><img src="/stream-chat-swift/img/logo.svg" alt="StreamChat Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/stream-chat-swift/img/logo.svg" alt="StreamChat Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">StreamChat Swift SDK Docs</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://github.com/GetStream/stream-chat-swift" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper main-docs-wrapper"><div class="docPage_31aa"><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">StreamChat Cheat Sheet</h1></header><div class="markdown"><p>This cheat sheet provides additional information to the official <a href="https://getstream.io/chat/docs/introduction/?language=swift" target="_blank" rel="noopener noreferrer">StreamChat SDK documentation</a> on our website. You can find here more detailed information, richer code snippets, and commentary to the provided solutions.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="summary"></a>Summary<a class="hash-link" href="#summary" title="Direct link to heading">#</a></h4><ul><li><a href="#chat-client">Chat Client</a><ul><li><a href="#creating-a-new-instance-of-chat-client">Creating a New Instance of Chat Client</a></li><li><a href="#how-many-chatclient-instances-do-i-need">How Many ChatClient Instances Do I Need?</a></li></ul></li><li><a href="#user">User</a><ul><li><a href="#setting-the-current-user">Setting the current user</a></li><li><a href="#logging-out">Logging out</a></li></ul></li><li><a href="#connection">Connection</a><ul><li><a href="#handling-the-connection-manually">Handling the connection manually</a></li><li><a href="#observing-connection-changes">Observing connection changes</a></li></ul></li><li><a href="#channel-list">Channel List</a><ul><li><a href="#getting-the-channels-with-the-current-user-as-member">Getting the Channels with the Current User as Member</a></li></ul></li><li><a href="#channel">Channel</a><ul><li><a href="#getting-messages-in-the-channel">Getting Messages in the Channel</a></li><li><a href="#creating-a-new-channel">Creating a new Channel</a></li><li><a href="#creating-a-new-1-1-channel">Creating a new 1-1 Channel</a></li></ul></li><li><a href="#messages">Messages</a><ul><li><a href="#sending-a-message">Sending a Message</a></li><li><a href="#deleting-a-message">Deleting a Message</a></li><li><a href="#editing-a-message">Editing a Message</a></li></ul></li><li><a href="#working-with-extra-data">Working with Extra Data</a><ul><li><a href="#what-is-extra-data">What is Extra Data</a></li><li><a href="#defining-custom-extra-data">Defining Custom Extra Data</a></li></ul></li><li><a href="#under-the-hood">Under the Hood</a></li></ul><hr><p>Didn&#x27;t find what you were looking for? Open an <a href="https://github.com/GetStream/stream-chat-swift/issues" target="_blank" rel="noopener noreferrer">issue in our repo</a> and suggest a new topic!</p><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="chat-client"></a>Chat Client<a class="hash-link" href="#chat-client" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="creating-a-new-instance-of-chat-client"></a>Creating a New Instance of Chat Client<a class="hash-link" href="#creating-a-new-instance-of-chat-client" title="Direct link to heading">#</a></h3><p>There are several basic approaches to creating a <code>ChatClient</code> instance.</p><p><strong>In the most simple setup, you can create a singleton instance</strong> of <code>ChatClient</code> and access it from everywhere:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">extension ChatClient {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    /// The singleton instance of `ChatClient`</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    static let shared: ChatClient = {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        let config = ChatClientConfig(apiKey: APIKey(&quot;qk4nn7rpcn75&quot;))</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        return ChatClient(config: config, tokenProvider: .closure { chatClient, completion in</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            let token = ... // Provide the StreamChat token for the current user</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            completion(.success(token))</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        })</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Another approach is to <strong>create <code>ChatClient</code> instance only locally and pass it down to the view controller hierarchy</strong>. </p><p>For example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">class AppDelegate: UIResponder, UIApplicationDelegate {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    func application(</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        _ application: UIApplication,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    ) Bool {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        let config = ChatClientConfig(apiKey: APIKey(&quot;qk4nn7rpcn75&quot;))</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        let chatClient = ChatClient(config: config, tokenProvider: .closure { chatClient, completion in</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            let token = ... // Provide the StreamChat token for the current user</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            completion(.success(token))</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        })</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        let rootViewController = YourMainViewController(chatClient: chatClient)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        // your code to make rootViewController visible</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        return true</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="how-many-chatclient-instances-do-i-need"></a>How Many <code>ChatClient</code> Instances Do I Need?<a class="hash-link" href="#how-many-chatclient-instances-do-i-need" title="Direct link to heading">#</a></h3><p>For the absolute majority of use cases, an app needs one instance of the <code>Client</code> object. </p><p><strong>You need multiple <code>Client</code> instances in one app when:</strong></p><ul><li>You want to simultaneously show content from multiple different chats (with different <code>AppId</code> values)</li><li>You want to simultaneously show the same content as seen for different kinds of users. For example, the left window for an admin user, the right window for an anonymous user. In this case, it&#x27;s recommended to always use <code>isLocalStorageEnabled = false</code> configuration.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="user"></a>User<a class="hash-link" href="#user" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="setting-the-current-user"></a>Setting the current user<a class="hash-link" href="#setting-the-current-user" title="Direct link to heading">#</a></h3><p>A valid StreamChat <code>token</code> is all you need to properly set your current app user as the current user of <code>ChatClient</code>. This token can&#x27;t be created locally and it must be provided by your backend.</p><p><code>ChatClient</code> uses <code>TokenProvider</code> to fetch the token of the currently logged in user from you. There are several types of <code>TokenProvider</code>s you can choose from:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">/// A token provider accepting a closure as a parameter. This is most likely the provider you </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">/// want to use in your production app.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">chatClient.tokenProvider = .closure { chatClient, completion in </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  let token = ... // Obtain the chat token from your system</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  completion(token)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">/// A token provider for anonymous users. You&#x27;d use this provider for situations when no</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">/// specific user is logged in.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">chatClient.tokenProvider = .anonymous</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">/// A token provider for a guest user with the specific &lt;id&gt; and name.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">chatClient.tokenProvider = .guest(userId: &lt;id&gt;, name: &quot;Luke&quot;, imageURL: nil)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">/// A token provider returning the hardcoded token</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">chatClient.tokenProvider = .static(&lt;token&gt;)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">/// A token provider that can be used for development. Development tokens are not validated by the servers.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">chatClient.tokenProvider = .development(userId: &lt;id&gt;)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>When the currently logged-in user of the app changes, or when you assign a new token provider to <code>ChatClient</code>, you should tell <code>ChatClient</code> to reload its current user:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">/// Gets a new token from `TokenProvider` and if the new user id differs from the current one, </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">/// reloads the data and reconnects with the new user.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">chatClient.currentUserController().reloadUserIfNeeded()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="logging-out"></a>Logging out<a class="hash-link" href="#logging-out" title="Direct link to heading">#</a></h3><p>It&#x27;s impossible to log out a user because the <code>Client</code> instance must always have a user assigned. </p><p><strong>However, you can simulate this behavior by:</strong></p><ul><li><strong>Destroying the current <code>Client</code> instance</strong></li></ul><p>You can destroy all references to the <code>Client</code> instance once you don&#x27;t need it. Every <code>Controller</code> holds a strong reference to the parent <code>Client</code> instance. You can use this to your advantage and have your view controllers holding a strong reference to <code>Client</code> via their referenced controllers. Once all view controllers are deallocated, so are the controllers and, finally, the <code>Client</code> instance.</p><ul><li>or <strong>Setting the current user as anonymous</strong></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">chatClient.tokenProvider = .anonymous</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">chatClient.currentUserController().reloadUserIfNeeded()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ul><li>or <strong>Disconnecting the client</strong></li></ul><p>This method makes the <code>Client</code> instance stop receiving any updates from the server. You can later reconnect without having to set the current user again.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">chatClient.connectionController().disconnect()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// when you want to reconnect</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">chatClient.connectionController().connect { error in </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    if error == nil {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       // connection successful</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="connection"></a>Connection<a class="hash-link" href="#connection" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="handling-the-connection-manually"></a>Handling the connection manually<a class="hash-link" href="#handling-the-connection-manually" title="Direct link to heading">#</a></h3><p>If <code>config.shouldConnectAutomatically</code> is set to <code>false</code> the establishment of a web-socket connection has to be done manually via <code>connect/disconnect</code> in <code>ChatConnectionController</code>, otherwise this is done automatically in the <code>CurrentUserController</code> when setting the current user.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">chatClient.connectionController().connect { error in </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    if error == nil {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       // connection successful</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// disconnecting</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">chatClient.connectionController().disconnect()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="observing-connection-changes"></a>Observing connection changes<a class="hash-link" href="#observing-connection-changes" title="Direct link to heading">#</a></h3><ul><li><strong>Using UIKit and Delegates</strong></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">class LoggedInUserViewController: UIViewController {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    ...</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    override func viewDidLoad() {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       super.viewDidLoad()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       chatClient.connectionController.delegate = self</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">extension LoggedInUserViewController: ChatConnectionControllerDelegate {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    func connectionController(_ controller: ChatConnectionController, didUpdateConnectionStatus status: ConnectionStatus) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        switch status {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        case .connected:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            onlineIndicatorView.tintColor = .green</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        case .disconnected, .disconnecting,  .initialized:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            onlineIndicatorView.tintColor = .red</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        case .connecting:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            break</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ul><li><strong>Using UIKit and Combine</strong></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">class LoggedInUserViewController: UIViewController {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">private var cancellables: Set&lt;AnyCancellable&gt; = []</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    override func viewDidLoad() {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       super.viewDidLoad()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        chatClient</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">             .connectionController</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">             .channelsChangesPublisher</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">             .receive(on: RunLoop.main)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">             .sink { [weak self] state in</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                // state changed</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">             }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">             .store(in: &amp;cancellables)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ul><li><strong>Using SwiftUI and Combine</strong></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">struct LoggedInUserView: View {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    @ObservedObject var connection: ChatConnectionController.ObservableObject</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    init(connectionController: ChatConnectionController) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        self.connection = connectionController.observableObject</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    var body: some View {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        switch connection.connectionStatus {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">         case .connected:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">             Text(&quot;Connected&quot;)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">         case .disconnected, .disconnecting:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">             Text(&quot;Disconnected&quot;)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">         case .connecting, .initialized:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">             Text(&quot;Connecting&quot;)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">         }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        .navigationBarTitle(&quot;Logged In User&quot;)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="channel-list"></a>Channel List<a class="hash-link" href="#channel-list" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="getting-the-channels-with-the-current-user-as-member"></a>Getting the Channels with the Current User as Member<a class="hash-link" href="#getting-the-channels-with-the-current-user-as-member" title="Direct link to heading">#</a></h3><ul><li><strong>Using UIKit and Delegates</strong></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">class ChannelListViewController: UIViewController {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    let channelListController = chatClient.channelListController(</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       query: ChannelListQuery(filter: .containMembers(userIds: [chatClient.currentUserId]))</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    )</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    override func viewDidLoad() {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       super.viewDidLoad()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       channelListController.delegate = self</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       // update your UI with the cached channels first, for example by calling reloadData() on UITableView</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       let locallyAvailableChannels = channelListController.channels</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       // call `synchronize()` to update the locally cached data. the updates will be delivered using delegate methods</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       channelListController.synchronize()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">extension ChannelListViewController: ChatChannelListControllerDelegate { </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    func controller(_ controller: ChatChannelListController, didChangeChannels changes: [ListChange&lt;Channel&gt;]) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        // The list of channels has changed. You can for example animate the changes:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        tableView.beginUpdates()        </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        for change in changes {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            switch change {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            case let .insert(_, index: index):</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                tableView.insertRows(at: [index], with: .automatic)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            // etc ...</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }        </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        tableView.endUpdates()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ul><li><strong>Using UIKit and Combine</strong></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">class ChannelsViewController: UIViewController {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    let channelListController = chatClient.channelListController(</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       query: ChannelListQuery(filter: .containMembers(userIds: [chatClient.currentUserId]))</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    )</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    private var cancellables: Set&lt;AnyCancellable&gt; = []</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    override func viewDidLoad() {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       super.viewDidLoad()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       // update your UI with the cached channels first, for example by calling reloadData() on UITableView</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       let locallyAvailableChannels = channelListController.channels</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       // Observe changes to the list from the publishers</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        channelListController</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">             .channelsChangesPublisher</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">             .receive(on: RunLoop.main)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">             .sink { [weak self] changes in</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                // animate the changes to the channel list</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">             }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">             .store(in: &amp;cancellables)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       // call `synchronize()` to update the locally cached data. the updates will be delivered using channelsChangesPublisher</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       channelListController.synchronize()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ul><li><strong>Using SwiftUI</strong></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// View definition</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">struct ChannelListView: View {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    @ObservedObject var channelList: ChatChannelListController.ObservableObject</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    init(channelListController: ChatChannelListController) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        self.channelList = channelListController.observableObject</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    var body: some View {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        VStack {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            List(channelList.channels, id: \.self) { channel in</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                Text(channel.extraData.name ?? &quot;missing channel name&quot;)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        .navigationBarTitle(&quot;Channels&quot;)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        .onAppear { </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            // call `synchronize()` to update the locally cached data.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            channelList.synchronize() </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// Usage</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">let channelListController = chatClient.channelListController(</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    query: ChannelListQuery(filter: .containMembers(userIds: [chatClient.currentUserId]))</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">let view = ChannelListView(channelListController: channelListController)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="channel"></a>Channel<a class="hash-link" href="#channel" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="getting-messages-in-the-channel"></a>Getting Messages in the Channel<a class="hash-link" href="#getting-messages-in-the-channel" title="Direct link to heading">#</a></h3><ul><li><strong>Using UIKit and Delegates</strong></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">class ChannelViewController: UIViewController {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">   let channelController = chatClient.channelController(cid: &lt;id of the channel&gt;)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">   override func viewDidLoad() {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       super.viewDidLoad()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       channelController.delegate = self</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       // update your UI with the cached messages first, for example by calling reloadData() on UITableView</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       let locallyAvailableMessages = channelController.messages</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       // call `synchronize()` to update the locally cached data. the updates will be delivered using delegate methods</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       channelController.synchronize()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">   }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">extension ChannelViewController: ChatChannelControllerDelegate { </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    func channelController(_ channelController: ChatChannelController, didUpdateMessages changes: [ListChange&lt;ChatMessage&gt;]) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        // For example, you can animate the changes in UITableView</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        tableView.beginUpdates()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        for change in changes {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            switch change {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            case let .insert(_, index: index):</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                tableView.insertRows(at: [index], with: .automatic)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            case let .move(_, fromIndex: fromIndex, toIndex: toIndex):</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                tableView.moveRow(at: fromIndex, to: toIndex)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            case let .update(_, index: index):</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                tableView.reloadRows(at: [index], with: .automatic)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            case let .remove(_, index: index):</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                tableView.deleteRows(at: [index], with: .automatic)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        tableView.endUpdates()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ul><li><strong>Using UIKit and Combine</strong></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">class ChannelViewController: UIViewController {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">   let channelController = chatClient.channelController(cid: &lt;id of the channel&gt;)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">   private var cancellables: Set&lt;AnyCancellable&gt; = []</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">   override func viewDidLoad() {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       super.viewDidLoad()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       // update your UI with the cached messages first, for example by calling reloadData() on UITableView</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       let locallyAvailableMessages = channelController.messages</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       // Observe changes to the list of messages</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        channelListController</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">             .messagesChangesPublisher</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">             .receive(on: RunLoop.main)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">             .sink { [weak self] changes in</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                // animate the changes to the message list</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">             }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">             .store(in: &amp;cancellables)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">   }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ul><li><strong>Using SwiftUI</strong></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// View definition</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">struct ChannelView: View {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    @ObservedObject var channelController: ChatChannelController.ObservableObject</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    init(channelController: ChatChannelController) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        self.channelController = channelController.observableObject</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    var body: some View {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        VStack {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            List(channelController.messages, id: \.self) { message in</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                Text(message.text)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        .navigationBarTitle(channelController.channel.name ?? &quot;Messages&quot;)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        .onAppear { </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            // call `synchronize()` to start updating the cached data</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            channelController.synchronize() </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// Usage</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">let channelController = chatClient.channelController(cid: &lt;channel id&gt;)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">let view = ChannelView(channelController: channelController)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="creating-a-new-channel"></a>Creating a new Channel<a class="hash-link" href="#creating-a-new-channel" title="Direct link to heading">#</a></h3><p>You can create a new channel by creating a <code>ChannelController</code> for it and calling <code>synchronize { error in ... }</code>. Once the completion block of <code>synchronize</code> is called, and the provided <code>error</code> is <code>nil</code>, the channel creation was successful.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">// A unique identifier of a channel</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">let id = UUID().uuidString</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// A `ChannelId` for the new channel. `ChannelId` is a combination of channel&#x27;s type and a unique identifier of the channel.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">let cid = ChannelId(type: .messaging, id: id)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">let controller = chatClient.channelController(</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    createChannelWithId: cid, // Assign `cid` for the new channel</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    members: [chatClient.currentUserId], // Add users to the new channel</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    extraData: .init(name: &quot;My new channel&quot;, imageURL: nil) // Set the name for the channel</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// At this point, the channel does not exist yet, but you can use the `controller` already. </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">//</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// This is handy for optimistic UI updates. You can already show the chat UI to the user while</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// the channel is being created. The message sending UI should be disabled until the `controller`&#x27;s state </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// changes to `remoteDataFetched`.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">let someViewController = SomeViewController(channelController: controller)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// ... your code to present the view controller</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// The channel is created when `synchronize { }` is called:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">controller.synchronize { error in</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    if error == nil {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        // The channel was successfully created</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">} </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="creating-a-new-1-1-channel"></a>Creating a new 1-1 Channel<a class="hash-link" href="#creating-a-new-1-1-channel" title="Direct link to heading">#</a></h3><p>Direct messaging channels derived their <code>ChannelId</code> automatically from their members. You can create a new 1-1 channel by creating a <code>ChannelController</code> for it and calling <code>synchronize { error in ... }</code>. Once the completion block of <code>synchronize</code> is called, and the provided <code>error</code> is <code>nil</code>, the channel creation was successful.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">let newChannelMemberIds: Set&lt;UserId&gt; = [chatClient.currentUserId, someOtherUserId]</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">let controller = chatClient.channelController(createDirectMessageChannelWith: newChannelMemberIds)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// At this point, the channel does not exist created yet, but you can use the `controller` already. </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">//</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// This is handy for optimistic UI updates. You can already show the chat UI to the user while</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// the channel is being created. The message sending UI should be disabled until the `controller`&#x27;s state </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// changes to `remoteDataFetched`. </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// If there are some existing messages between the current user and `someOtherUser`, they will</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// be loaded automatically by `controller`.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">let someViewController = SomeViewController(channelController: controller)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// ... your code to present the view controller</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// The channel is created when `synchronize { }` is called:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">controller.synchronize { error in</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    if error == nil {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        // The channel was successfully created</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">} </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="messages"></a>Messages<a class="hash-link" href="#messages" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="sending-a-message"></a>Sending a Message<a class="hash-link" href="#sending-a-message" title="Direct link to heading">#</a></h3><p>Sending a new message to a channel has several phases.</p><p><strong><code>Message.localState</code> phases when sending a message:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">                                    ┌──▶  `nil` if success </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  `pendingSend` ──────▶ `sending` ──┤                      </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                                    └─▶   `sendingFailed`                                                         </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This behavior makes it possible to update your UI with the new message immediately without blocking the UI.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">class MyChannelViewController: UIViewController {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    let controller = ChannelController(cid: &lt;id of the channel&gt;)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    func sendMessage(text: String) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        // This method creates a new message locally, initially with `localState == .pendingSend`</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        controller.createNewMessage(text: text)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    // Example handling for Message local state:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) UITableViewCell { </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        ...</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        let message = controller.messages[indexPath.row]</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        if message.localState == .pendingSend {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            // show message as pending send</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        } else if message.localState == .sendingFailed {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            // show retry button for the message</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        ...</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="deleting-a-message"></a>Deleting a Message<a class="hash-link" href="#deleting-a-message" title="Direct link to heading">#</a></h3><p>Deleting a message is performed using a <code>MessageController</code> created for the given message.</p><p><strong><code>Message.localState</code> phases when deleting a message:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">                ┌──▶  `nil` if success </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">   `deleting` ──┤                      </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                └─▶  `deletingFailed`                                </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">class MyChannelViewController: UIViewController {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    let controller = ChannelController(cid: &lt;id of the channel&gt;)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    func deleteMessage(message: Message) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        // Create a `MessageController` for the message you want to delete</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        let messageController = controller.client.messageController(</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            cid: channelController.channelQuery.cid,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            messageId: message.id</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        )</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        // Delete the message</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        messageController.deleteMessage()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    // Example handling for Message local state:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) UITableViewCell { </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        ...</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        let message = controller.messages[indexPath.row]</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        if message.localState == .deleting {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            // show message as being deleted</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        } else if message.localState == .deletingFailed {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            // show retry button for deleting the message</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        ...</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="editing-a-message"></a>Editing a Message<a class="hash-link" href="#editing-a-message" title="Direct link to heading">#</a></h3><p>Editing a message has several phases.</p><p><strong><code>MessageModel.localState</code> phases when editing a message:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">                                    ┌──▶  `nil` if success </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  `pendingSync` ──────▶ `syncing` ──┤                      </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                                    └─▶   `syncingFailed`                                                         </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This behavior makes it possible to update your UI with the updated message immediately without blocking the UI.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">class MyChannelViewController: UIViewController {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    let controller = ChannelController(cid: &lt;id of the channel&gt;)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    func editMessage(message: ChatMessage, text: String) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        let messageController = controller.client.messageController(cid: &lt;id of the channel&gt;, messageId: message.id)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        // This method updates a message locally with the `localState == .pendingSync`</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        messageController.editMessage(text: text)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    // Example handling for Message local state:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) UITableViewCell { </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        ...</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        let message = controller.messages[indexPath.row]</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        if message.localState == .pendingSync {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            // show message as not being synced with the servers</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        } else if message.localState == .syncingFailed {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            // show retry button</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        ...</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="working-with-extra-data"></a>Working with Extra Data<a class="hash-link" href="#working-with-extra-data" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="what-is-extra-data"></a>What is Extra Data<a class="hash-link" href="#what-is-extra-data" title="Direct link to heading">#</a></h3><p>You can add additional (extra) data to entities in the chat system. For now, you can add extra data to <code>ChatUser</code>, <code>ChatChannel</code>, and <code>ChatMessage</code>.</p><p>The extra data types are defined using the <code>ExtraDataTypes</code> protocol the <code>ChatClient</code> and other types are generic over. Here you can see the protocol declaration including the default extra data types for the mentioned entities:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">public protocol ExtraDataTypes {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    /// An extra data type for `ChatUser`.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    associatedtype User: UserExtraData = NoExtraData</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    /// An extra data type for `ChatMessage`.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    associatedtype Message: MessageExtraData = NoExtraData</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    /// An extra data type for `ChatChannel`.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    associatedtype Channel: ChannelExtraData = NoExtraData</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    /// An extra data type for `ChatMessageReaction`.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    associatedtype MessageReaction: MessageReactionExtraData = NoExtraData</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    /// An extra data type for `ChatMessageAttachment`.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    associatedtype Attachment: AttachmentExtraData = NoExtraData</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">class _ChatClient&lt;ExtraData: ExtraDataTypes&gt; { ... }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>To make working with generic types more convenient, we expose several typealiases. This way, generic types&#x27; underlying extra data complexity is hidden, while the whole system stays safe at compile-time. </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">/// A convenience typealias for `ChatClient` with the default data types.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public typealias ChatClient = _ChatClient&lt;NoExtraData&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">/// A convenience typealias for `ChatUser` with the default data types.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public typealias ChatUser = _ChatUser&lt;NoExtraData&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">/// A convenience typealias for `ChatChannel` with the default data types.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public typealias ChatChannel = _Chatchannel&lt;NoExtraData&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">...</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><hr><p>⚠️ <strong>Important:</strong> If the name of the type has the <code>_</code> prefix, it&#x27;s not meant to be used directly. You should instead use the convenience typealias without the prefix.</p><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="defining-custom-extra-data"></a>Defining Custom Extra Data<a class="hash-link" href="#defining-custom-extra-data" title="Direct link to heading">#</a></h3><p>Changing the default extra data types with your custom types is easy and takes a couple of easy steps.</p><p>For example, let&#x27;s say you want to replace the default <code>NoExtraData</code> of <code>ChatChannel</code> with your custom <code>NameAndColorExtraData</code>:</p><p><strong>1. Define your custom Channel extra data type</strong></p><p>Your custom data type must conform to the <code>ChannelExtraData</code> protocol. The protocol has two requirements: the type must be codable, and it must expose a static <code>defaultValue</code> variable.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">/// Your custom ChatChannel extra data type</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">struct NameAndColorExtraData: ChannelExtraData {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    /// The value used when decoding the custom data type fails.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    static var defaultValue = NameAndColorExtraData(name: &quot;Unknown&quot;, colorName: nil)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    let name: String</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    let colorName: String?</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><strong>2. Use the type in your custom implementation of <code>ExtraDataTypes</code></strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">/// Custom implementation of `ExtraDataTypes` with `NameAndColorExtraData`</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">enum MyCustomExtraData: ExtraDataTypes {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    typealias Channel = NameAndColorExtraData</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    // Note: Unless you specify other custom data types, the default data types are used.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><strong>3. Define the following typealiases in your module</strong></p><p>You should define the convenience typealiases in the module where you use <code>StreamChat</code>. You can copy&amp;paste the snippet below, and replace <code>MyCustomExtraData</code> with the type defined in step 2.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">import StreamChat</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// Change this typealias to your custom data types</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">typealias CustomExtraDataTypes = MyCustomExtraData // 👈 Your_Custom_Data_Type_Here 👈</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">typealias ChatClient = _ChatClient&lt;CustomExtraDataTypes&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">typealias ChatUser = _ChatUser&lt;CustomExtraDataTypes.User&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">typealias CurrentChatUser = _CurrentChatUser&lt;CustomExtraDataTypes.User&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">typealias ChatChannel = _ChatChannel&lt;CustomExtraDataTypes&gt; </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">typealias ChatChannelRead = _ChatChannelRead&lt;CustomExtraDataTypes&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">typealias ChatChannelMember = _ChatChannelMember&lt;CustomExtraDataTypes.User&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">typealias ChatMessage = _ChatMessage&lt;CustomExtraDataTypes&gt; </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">typealias CurrentChatUserController = _CurrentChatUserController&lt;CustomExtraDataTypes&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">typealias ChatChannelListController = _ChatChannelListController&lt;CustomExtraDataTypes&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">typealias ChatChannelController = _ChatChannelController&lt;CustomExtraDataTypes&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">typealias ChatMessageController = _ChatMessageController&lt;CustomExtraDataTypes&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="important"></a><strong>Important</strong><a class="hash-link" href="#important" title="Direct link to heading">#</a></h4><p>Extra data is embedded directly to the root object, not nested under any <code>extraData</code> object.</p><p>So if you have such a Channel object:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">{</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  &#x27;id&#x27;: ....,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  // all other default fields</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  &#x27;color&#x27;: &#x27;red&#x27;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>You&#x27;d use the <code>MyCustomExtraData</code> defined above.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="under-the-hood"></a>Under the Hood<a class="hash-link" href="#under-the-hood" title="Direct link to heading">#</a></h2><p>This section contains additional information about the SDK, which might help you use it best. However, you don&#x27;t need to know such details for most use cases to use it in your project successfully.</p><p>WIP</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/GetStream/stream-chat-swift/edit/main/stream-chat-swift-docs/docs/cheat-sheet.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#chat-client" class="table-of-contents__link">Chat Client</a><ul><li><a href="#creating-a-new-instance-of-chat-client" class="table-of-contents__link">Creating a New Instance of Chat Client</a></li><li><a href="#how-many-chatclient-instances-do-i-need" class="table-of-contents__link">How Many <code>ChatClient</code> Instances Do I Need?</a></li></ul></li><li><a href="#user" class="table-of-contents__link">User</a><ul><li><a href="#setting-the-current-user" class="table-of-contents__link">Setting the current user</a></li><li><a href="#logging-out" class="table-of-contents__link">Logging out</a></li></ul></li><li><a href="#connection" class="table-of-contents__link">Connection</a><ul><li><a href="#handling-the-connection-manually" class="table-of-contents__link">Handling the connection manually</a></li><li><a href="#observing-connection-changes" class="table-of-contents__link">Observing connection changes</a></li></ul></li><li><a href="#channel-list" class="table-of-contents__link">Channel List</a><ul><li><a href="#getting-the-channels-with-the-current-user-as-member" class="table-of-contents__link">Getting the Channels with the Current User as Member</a></li></ul></li><li><a href="#channel" class="table-of-contents__link">Channel</a><ul><li><a href="#getting-messages-in-the-channel" class="table-of-contents__link">Getting Messages in the Channel</a></li><li><a href="#creating-a-new-channel" class="table-of-contents__link">Creating a new Channel</a></li><li><a href="#creating-a-new-1-1-channel" class="table-of-contents__link">Creating a new 1-1 Channel</a></li></ul></li><li><a href="#messages" class="table-of-contents__link">Messages</a><ul><li><a href="#sending-a-message" class="table-of-contents__link">Sending a Message</a></li><li><a href="#deleting-a-message" class="table-of-contents__link">Deleting a Message</a></li><li><a href="#editing-a-message" class="table-of-contents__link">Editing a Message</a></li></ul></li><li><a href="#working-with-extra-data" class="table-of-contents__link">Working with Extra Data</a><ul><li><a href="#what-is-extra-data" class="table-of-contents__link">What is Extra Data</a></li><li><a href="#defining-custom-extra-data" class="table-of-contents__link">Defining Custom Extra Data</a></li></ul></li><li><a href="#under-the-hood" class="table-of-contents__link">Under the Hood</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/stream-chat" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://twitter.com/getstream_io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/GetStream/stream-chat-swift" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 Stream.io, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/stream-chat-swift/assets/js/styles.725bd164.js"></script>
<script src="/stream-chat-swift/assets/js/runtime~main.68d9852c.js"></script>
<script src="/stream-chat-swift/assets/js/main.c61111f0.js"></script>
<script src="/stream-chat-swift/assets/js/1.7f645e49.js"></script>
<script src="/stream-chat-swift/assets/js/2.1b2f1115.js"></script>
<script src="/stream-chat-swift/assets/js/3.1f8766f7.js"></script>
<script src="/stream-chat-swift/assets/js/1be78505.65f3230c.js"></script>
<script src="/stream-chat-swift/assets/js/57.a41a6dc4.js"></script>
<script src="/stream-chat-swift/assets/js/935f2afb.560ad559.js"></script>
<script src="/stream-chat-swift/assets/js/17896441.7cc4e2aa.js"></script>
<script src="/stream-chat-swift/assets/js/1666e941.be513990.js"></script>
</body>
</html>